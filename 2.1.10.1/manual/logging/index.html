<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="High performance Java client for Apache Cassandra">
    <meta name="author" content="DataStax">

    <title>Java Driver for Apache Cassandra - Logging</title>

    <link rel="icon" href="../../../favicon.ico">
    <link rel="apple-touch-icon" href="../../../favicon.png">
    <link href="../../../css/style.css" rel="stylesheet">
    <link href="../../../css/pygments.css" rel="stylesheet">
    <link href="../../../css/hotkeys.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body ng-app="docs">
    <div class="navbar">
      <div class="container-fluid">
        <div class="row row-offcanvas row-offcanvas-left">
          <div class="col-sm-3 text-center">
            <a class="ds-home" href="../../"><img alt="Brand" src="../../../img/logo.png"></a>
            <ul class="list-inline ds-sites" role="nav">
              <li><a href="https://academy.datastax.com/" class="navbar-link">DataStax Academy</a></li>
              <li><a href="http://www.datastax.com/dev/blog" class="navbar-link">Tech Blog</a></li>
              <li><a href="http://www.datastax.com/what-we-offer/products-services/support" class="navbar-link">Support</a></li>
            </ul>
          </div>
          <div class="col-md-5">
            <p class="lead pubtitle">Java Driver for Apache Cassandra</p>
            
            <div class="text-info">
              <span class="text-warning">Attention:</span> Viewing documentation for version
              <div class="btn-group">
                <button id="current-version" class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  2.1.10.1
                  <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="current-version">
                
                  <li><a href="../../../manual/logging/">3.1.0</a></li>
                
                  <li><a href="../../../3.0.3/manual/logging/">3.0.3</a></li>
                
                  <li><a href="../../../3.0.1/manual/logging/">3.0.1</a></li>
                
                  <li><a href="../../../3.0.0/manual/logging/">3.0.0</a></li>
                
                  <li class="disabled"><a href="./">2.1.10.1</a></li>
                
                  <li><a href="../../../2.1.10/manual/logging/">2.1.10</a></li>
                
                  <li><a href="../../../2.1.9/">2.1.9</a></li>
                
                  <li><a href="../../../2.1.8/">2.1.8</a></li>
                
                  <li><a href="../../../2.1.7/">2.1.7</a></li>
                
                  <li><a href="../../../2.0.12.1/">2.0.12.1</a></li>
                
                  <li><a href="../../../2.0.12/">2.0.12</a></li>
                
                  <li><a href="../../../2.0.11/">2.0.11</a></li>
                
                </ul>
              </div>
            </div>
            
          </div>
          <div class="col-md-4">
            <form id="search" class="form-search dropdown visible-lg-inline-block" ng-controller="search" ng-class="{open: hasResults}" role="search" ng-submit="submit()" data-spy="affix" data-offset-top="130">
              <div class="form-group has-feedback">
                <input type="search" class="form-control input-sm mousetrap" placeholder="Search..." ng-model="q" ng-change="search('2.1.10.1')" ng-disabled="!searchReady" disabled data-hotkey="{down: moveDown, up: moveUp, esc: reset}" data-search>
              </div>
              <ul class="dropdown-menu search-results" role="menu">
                <li ng-repeat="result in results" ng-class="{'bg-warning': $index == current}"><a ng-href="{{basePath}}{{result.path}}"><span ng-bind-html="summary(result)"></span></a></li>
              </ul>
            </form>
            <a href="http://www.datastax.com/download" class="btn btn-primary btn-sm">Download</a>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid" id="content">
      <div class="row">
        <div class="col-md-3">
          <div id="navigation" class="side-nav" role="tablist" aria-multiselectable="true">
            <h3><a href="../../">Contents</a></h3>
            <ul class="nav nav-pills nav-stacked">
  
  
  <li>
    <a href="../../changelog/">
      Changelog <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../faq/">
      Frequently Asked Questions <small>page</small>
      
    </a>
    
  </li>
  
  
  <li class="active">
    <a href="../">
      Manual <small>page</small>
      
      
      <span class="glyphicon glyphicon-minus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    <ul class="nav nav-pills nav-stacked">
  
  
  <li>
    <a href="../address_resolution/">
      Address resolution <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../async/">
      Asynchronous programming <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../auth/">
      Authentication <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../compression/">
      Compression <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../pooling/">
      Connection pooling <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../control_connection/">
      Control connection <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../load_balancing/">
      Load balancing <small>page</small>
      
    </a>
    
  </li>
  
  
  <li class="active">
    <a href="./" class="current">
      Logging <small>page</small>
      
    </a>
    <ul class="nav nav-pills nav-stacked">
  
</ul>

  </li>
  
  
  <li>
    <a href="../metadata/">
      Metadata <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../metrics/">
      Metrics <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../native_protocol/">
      Native protocol <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../object_mapper/">
      Object Mapper <small>page</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../paging/">
      Paging <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../idempotence/">
      Query idempotence <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../query_timestamps/">
      Query timestamps <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../reconnection/">
      Reconnection <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../retries/">
      Retries <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../ssl/">
      SSL <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../socket_options/">
      Socket options <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../speculative_execution/">
      Speculative query execution <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../statements/">
      Statements <small>page</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../tuples/">
      Tuples <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../udts/">
      User-defined types <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../shaded_jar/">
      Using the shaded JAR <small>page</small>
      
    </a>
    
  </li>
  
</ul>

  </li>
  
  
  <li>
    <a href="../../upgrade_guide/">
      Upgrade guide <small>page</small>
      
    </a>
    
  </li>
  
</ul>

          </div>
        </div>
        <div class="col-md-9 content">
          <div class="crumbs-wrapper">
            <nav id="crumbs" data-spy="affix" data-offset-top="130">
              <ol class="breadcrumb">
                
                
                
                <li><a href="../../">Home</a></li>
                
                
                
                
                
                <li><a href="../">Manual</a></li>
                
                
                
                
                
                <li class="active">Logging</li>
                
                
                
              </ol>
            </nav>
          </div>
          

<h2 id="logging" class="target">Logging<a class="anchor" href="#logging" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>

<h3 id="setup" class="target">Setup<a class="anchor" href="#setup" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>DataStax Java driver uses the popular <a href="http://www.slf4j.org">SLF4J</a> library to emit log messages; 
SLF4J has the advantage of providing a logging API that is entirely decoupled from concrete
implementations, letting client applications free to seamlessly connect SLF4J to their preferred logging backend.</p>

<p>The driver itself does not attempt to configure any concrete logging framework. 
It is up to client applications using the driver to correctly set up their classpath and 
runtime configuration to be able to capture log messages emitted by the driver.
Concretely, client applications need to provide, at runtime, a <em>binding</em> to any logging framework 
of their choice that is <a href="http://www.slf4j.org/manual.html#swapping">compatible with SLF4J</a>.</p>

<p>If your application is built with Maven, this usually involves adding one (runtime) dependency to your POM file.
For example, if you intend to use <a href="http://logback.qos.ch">Logback</a>, add the following dependency:</p>
<pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.1.3<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre>
<p>If you are using Log4J 1.2 instead, add the following dependency:</p>
<pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.7.12<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre>
<p>Check <a href="http://www.slf4j.org/manual.html#projectDep">SLF4J’s documentation</a> for examples for 
other logging frameworks, and for troubleshooting dependency resolution problems. </p>

<h3 id="configuration" class="target">Configuration<a class="anchor" href="#configuration" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>Each logging framework has its own configuration rules, but all of them provide
different levels (DEBUG, INFO, WARN, ERROR…), different <em>loggers</em> or <em>categories</em>
(messages from different categories or loggers can be filtered out separately or printed out
differently), and different <em>appenders</em> (message receptacles such as the standard console,
the error console, a file on disk, a socket…).</p>

<p>Check your logging framework documentation for more information about how to properly configure it.
You can also find some configuration examples below.</p>

<h3 id="useful-loggers" class="target">Useful loggers<a class="anchor" href="#useful-loggers" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>When debugging the Java driver, the following loggers could be particularly useful
and provide hints about what’s going wrong.</p>

<ul>
<li>
<code>com.datastax.driver.core.Cluster</code>

<ul>
<li>ERROR

<ul>
<li>Authentication errors</li>
<li>Unexpected errors when handling events, reconnecting, refreshing schemas</li>
<li>Unexpected events</li>
</ul>
</li>
<li>WARN

<ul>
<li>Cluster name mismatches</li>
<li>Unreachable contact points</li>
<li>Unsupported protocol versions </li>
<li>Schema disagreements</li>
<li>Ignored notifications due to high contention</li>
</ul>
</li>
<li>INFO

<ul>
<li>Hosts added or removed</li>
</ul>
</li>
<li>DEBUG

<ul>
<li>Cluster lifecycle (start, shutdown)</li>
<li>Event delivery notifications (schema changes, topology changes)</li>
<li>Topology change events: hosts Up / Down / Added / Removed</li>
<li>Hosts being ignored</li>
<li>Protocol version negotiation</li>
<li>Reconnection attempts</li>
<li>Schema metadata refreshes</li>
</ul>
</li>
<li>TRACE

<ul>
<li>Connection pools lifecycle (create, renew, refresh)</li>
</ul>
</li>
</ul>
</li>
<li>
<code>com.datastax.driver.core.Session</code>

<ul>
<li>ERROR

<ul>
<li>Errors related to connection pools</li>
</ul>
</li>
<li>WARN

<ul>
<li>Problems related to connection pools</li>
</ul>
</li>
<li>DEBUG

<ul>
<li>Connection pools lifecycle (create, renew, refresh)</li>
</ul>
</li>
</ul>
</li>
<li>
<code>com.datastax.driver.core.RequestHandler</code>

<ul>
<li>ERROR

<ul>
<li>Unexpected errors preparing queries</li>
<li>Queries sent to a bootstrapping host</li>
<li>Unexpected server errors</li>
</ul>
</li>
<li>WARN

<ul>
<li>Queries sent to an overloaded host</li>
</ul>
</li>
<li>INFO

<ul>
<li>Unprepared queries</li>
</ul>
</li>
<li>DEBUG

<ul>
<li>Retry attempts</li>
</ul>
</li>
<li>TRACE

<ul>
<li>Host currently being queried</li>
</ul>
</li>
</ul>
</li>
<li>
<code>com.datastax.driver.core.Connection</code>

<ul>
<li>WARN

<ul>
<li>Problem setting keyspace</li>
<li>Errors closing Netty channel</li>
</ul>
</li>
<li>DEBUG

<ul>
<li>Connection lifecycle (open, close, defunct)</li>
<li>Error connecting or writing requests</li>
<li>Heartbeats</li>
</ul>
</li>
<li>TRACE

<ul>
<li>Authentication progress</li>
<li>Sending requests</li>
<li>Receiving responses</li>
</ul>
</li>
</ul>
</li>
</ul>

<h3 id="logging-query-latencies" class="target">Logging query latencies<a class="anchor" href="#logging-query-latencies" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>The <code>QueryLogger</code> provides clients with the ability to log queries
executed by the driver, and especially, it allows client to track slow
queries, i.e. queries that take longer to complete than a configured
threshold in milliseconds.</p>

<p>To turn on this feature, you first need to instantiate and register a <code>QueryLogger</code> instance:</p>
<pre class="highlight"><code><span class="n">Cluster</span> <span class="n">cluster</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">QueryLogger</span> <span class="n">queryLogger</span> <span class="o">=</span> <span class="n">QueryLogger</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">cluster</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withConstantThreshold</span><span class="o">(...)</span>
    <span class="o">.</span><span class="na">withMaxQueryStringLength</span><span class="o">(...)</span>
<span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">cluster</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">queryLogger</span><span class="o">);</span>
</code></pre>
<p>Note that <code>QueryLogger</code> instances are thread-safe and can be shared cluster-wide. 
Besides, you can adjust several parameters such as the maximum query string length to be printed, 
the maximum number of parameters to print, etc. Refer to the 
<code>QueryLogger</code> <a href="http://docs.datastax.com/en/drivers/java/2.1/com/datastax/driver/core/QueryLogger.html">API docs</a> for more information.</p>

<p>Secondly, you need to adjust your logging framework to accept log messages from the <code>QueryLogger</code>. The <code>QueryLogger</code>
uses 3 different loggers:</p>

<ul>
<li>
<code>com.datastax.driver.core.QueryLogger.NORMAL</code> : Used to log normal queries, i.e., queries that completed successfully within a configurable threshold in milliseconds.</li>
<li>
<code>com.datastax.driver.core.QueryLogger.SLOW</code> : Used to log slow queries, i.e., queries that completed successfully but that took longer than a configurable threshold in milliseconds to complete.</li>
<li>
<code>com.datastax.driver.core.QueryLogger.ERROR</code>: Used to log unsuccessful queries, i.e., queries that did not complete normally and threw an exception. Note this this logger will also print the full stack trace of the reported exception.</li>
</ul>

<p>You need to set the above loggers to DEBUG level to turn them on. E.g. to track queries
that take more than 300 ms to complete, configure your <code>QueryLogger</code> with that threshold (see above), 
then set the <code>com.datastax.driver.core.QueryLogger.SLOW</code> logger to DEBUG, e.g. with Log4J:</p>
<pre class="highlight"><code>  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.datastax.driver.core.QueryLogger.SLOW"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"DEBUG"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>
</code></pre>
<p>The <code>QueryLogger</code> would then print messages such as this for every slow query:</p>
<pre><code>DEBUG [cluster1] [/127.0.0.1:9042] Query too slow, took 329 ms: SELECT * FROM users WHERE user_id=?;
</code></pre>
<p>As you can see, actual query parameters are not logged; if you want them to be printed as well, set the <code>com.datastax.driver.core.QueryLogger.SLOW</code> logger
to TRACE instead, e.g. with Log4J:</p>
<pre class="highlight"><code>  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.datastax.driver.core.QueryLogger.SLOW"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"TRACE"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>
</code></pre>
<p>The <code>QueryLogger</code> would then print messages such as this for every slow query:</p>
<pre><code>TRACE [cluster1] [/127.0.0.1:9042] Query too slow, took 329 ms: SELECT * FROM users WHERE user_id=? [user_id=42];
</code></pre>
<p>Be careful when logging large query strings (specially batches) and/or queries with considerable amounts of parameters. 
See the <code>QueryLogger</code> <a href="http://docs.datastax.com/en/drivers/java/2.1/com/datastax/driver/core/QueryLogger.html">API docs</a> for examples of how to truncate the printed message when necessary.</p>

<h4 id="constant-vs-dynamic-thresholds" class="target">Constant vs Dynamic thresholds<a class="anchor" href="#constant-vs-dynamic-thresholds" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h4>

<p>Currently the <code>QueryLogger</code> can be configured to track slow queries using either 
a constant threshold in milliseconds (which is the default behavior), or 
a dynamic threshold based on latency percentiles, as computed by a <code>PercentileTracker</code> (see the
<a href="../speculative_execution/#percentile-speculative-execution-policy">speculative executions</a> section for more information
about percentile trackers).</p>

<p>Refer to the <code>QueryLogger</code> <a href="http://docs.datastax.com/en/drivers/java/2.1/com/datastax/driver/core/QueryLogger.html">API docs</a> for an example of usage.</p>

<h3 id="performance-tips" class="target">Performance Tips<a class="anchor" href="#performance-tips" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<ul>
<li>Use asynchronous appenders; both <a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/AsyncAppender.html">Log4J</a> 
and <a href="http://logback.qos.ch/manual/appenders.html#AsyncAppender">Logback</a> provide asynchronous appenders 
that can significantly boost latencies when writing log messages.</li>
<li>While the driver does not provide such capability, it is possible for client applications to hot-reload the log configuration
without stopping the application. This usually involves JMX and is available for <a href="http://logback.qos.ch/manual/jmxConfig.html">Logback</a>;
Log4J provides a <code>configureAndWatch()</code> method but it is not recommended to use it inside J2EE containers (see <a href="https://logging.apache.org/log4j/1.2/faq.html#a3.6">FAQ</a>).</li>
</ul>

<h3 id="logback-example" class="target">Logback Example<a class="anchor" href="#logback-example" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>Here is a typical example configuration for Logback. <em>Please adapt it to your specific needs before using it!</em></p>

<p>It logs messages to the console with levels equal to or higher than INFO, and logs all messages to a rolling file. 
By default, only messages with ERROR level or higher are logged.</p>

<p>It also turns on slow query tracing as described above.</p>
<pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

    <span class="c">&lt;!-- log INFO or higher messages to the console --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"console"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%-5p %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="c">&lt;!-- log everything to a rolling file --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;file&gt;</span>driver.log<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%-5p [%d{ISO8601}] [%t] %F:%L - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
        <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- daily rollover --&gt;</span>
            <span class="nt">&lt;fileNamePattern&gt;</span>driver.%d{yyyy-MM-dd}.log<span class="nt">&lt;/fileNamePattern&gt;</span>
            <span class="c">&lt;!-- keep 30 days' worth of history --&gt;</span>
            <span class="nt">&lt;maxHistory&gt;</span>30<span class="nt">&lt;/maxHistory&gt;</span>
    <span class="nt">&lt;/rollingPolicy&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="c">&lt;!-- use AsyncAppender for lower latencies --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"async"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.AsyncAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"console"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"file"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>

    <span class="c">&lt;!--
    Turn on slow query logging by setting this logger to DEBUG; 
    set level to TRACE to also log query parameters 
    --&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.datastax.driver.core.QueryLogger.SLOW"</span> <span class="na">level=</span><span class="s">"DEBUG"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"ERROR"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"async"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</code></pre>
<h3 id="log4j-example" class="target">Log4J Example<a class="anchor" href="#log4j-example" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h3>

<p>Here is a typical example configuration for Log4J. <em>Please adapt it to your specific needs before using it!</em></p>

<p>It logs messages to the console with levels equal to or higher than INFO, and logs all messages to a rolling file. 
By default, only messages with ERROR level or higher are logged.</p>

<p>It also turns on slow query tracing as described above.</p>
<pre class="highlight"><code><span class="nt">&lt;log4j:configuration&gt;</span>

  <span class="c">&lt;!-- log INFO or higher messages to the console --&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"console"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.ConsoleAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"threshold"</span> <span class="na">value=</span><span class="s">"INFO"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"org.apache.log4j.PatternLayout"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ConversionPattern"</span> <span class="na">value=</span><span class="s">"%-5p %m%n"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/layout&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="c">&lt;!-- log everything to a rolling file --&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.RollingFileAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">value=</span><span class="s">"driver.log"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"append"</span> <span class="na">value=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"maxFileSize"</span> <span class="na">value=</span><span class="s">"1GB"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"maxBackupIndex"</span> <span class="na">value=</span><span class="s">"10"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"org.apache.log4j.PatternLayout"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ConversionPattern"</span> <span class="na">value=</span><span class="s">"%-5p [%d{ISO8601}] [%t] %F:%L - %m%n"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/layout&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="c">&lt;!-- use AsyncAppender for lower latencies --&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"async"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.AsyncAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"BufferSize"</span> <span class="na">value=</span><span class="s">"500"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"file"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"console"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="c">&lt;!--
   Turn on slow query logging by setting this logger to DEBUG; 
   set level to TRACE to also log query parameters 
  --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.datastax.driver.core.QueryLogger.SLOW"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"DEBUG"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>

  <span class="nt">&lt;root&gt;</span>
    <span class="nt">&lt;priority</span> <span class="na">value=</span><span class="s">"ERROR"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"async"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/root&gt;</span>

<span class="nt">&lt;/log4j:configuration&gt;</span>
</code></pre>


        </div>
      </div>
    </div>

    
    <footer class="container text-muted">
      <ul class="list-inline">
      
        
        <li>
          <a href="https://github.com/datastax/java-driver/">Code</a>
        </li>
      
        <li>·</li>
        <li>
          <a href="http://datastax.github.io/java-driver/">Docs</a>
        </li>
      
        <li>·</li>
        <li>
          <a href="https://datastax-oss.atlassian.net/browse/JAVA/">Issues</a>
        </li>
      
        <li>·</li>
        <li>
          <a href="https://groups.google.com/a/lists.datastax.com/forum/#!forum/java-driver-user">Mailing List</a>
        </li>
      
        <li>·</li>
        <li>
          <a href="irc://irc.freenode.net/datastax-drivers">IRC Channel</a>
        </li>
      
        <li>·</li>
        <li>
          <a href="https://github.com/datastax/java-driver/releases">Releases</a>
        </li>
      
      </ul>
    </footer>
    

    <script src="../../../js/jquery.js"></script>
    <script src="../../../js/bootstrap.js"></script>
    <script src="../../../js/angular.js"></script>
    <script src="../../../js/mousetrap.js"></script>
    <script src="../../../js/hotkeys.js"></script>
    <script src="../../../js/ZeroClipboard.js"></script>
    <script src="../../../js/lunr.js"></script>
    <script src="../../../js/app.js"></script>
  </body>
</html>
